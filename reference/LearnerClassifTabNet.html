<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Keras TabNet Neural Network for Classification — LearnerClassifTabNet • mlr3keras</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<link href="../extra.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Keras TabNet Neural Network for Classification — LearnerClassifTabNet" />
<meta property="og:description" content="Implementation of &quot;TabNet&quot; from the paper TabNet: Attentive Interpretable Tabular Learning (Sercan, Pfister, 2019).
See https://arxiv.org/abs/1908.07442 for details." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a href="https://mlr-org.com"><img src="https://raw.githubusercontent.com/mlr-org/mlr3/master/man/figures/logo.png" id="hexlogo" alt="mlr-org" /></a>
        <a class="navbar-brand" href="../index.html">mlr3keras <small>v0.1.3</small></a>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../reference/index.html">
    <span class="fa fa fa fa-file-alt"></span>
     
    Reference
  </a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://mlr3book.mlr-org.com">
    <span class="fa fa fa fa-link"></span>
     
    mlr3book
  </a>
</li>
<li>
  <a href="../articles/mlr3keras.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/usecase_bostonhousing.html">Boston Housing Task</a>
    </li>
  </ul>
</li>
        <li>
  <a href="https://github.com/mlr-org/mlr3keras/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://lmmisld-lmu-stats-slds.srv.mwn.de/mlr_invite/">
    <span class="fa fa fa fa-comments"></span>
     
  </a>
</li>
<li>
  <a href="https://stackoverflow.com/questions/tagged/mlr3">
    <span class="fab fa-stack-overflow"></span>
     
  </a>
</li>
<li>
  <a href="https://mlr-org.com/">
    <span class="fas fa-rss"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right docsearch" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Keras TabNet Neural Network for Classification</h1>
    <small class="dont-index">Source: <a href='https://github.com/mlr-org/mlr3keras/blob/master/R/LearnerTabNet.R'><code>R/LearnerTabNet.R</code></a></small>
    <div class="hidden name"><code>LearnerClassifTabNet.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Implementation of "TabNet" from the paper TabNet: Attentive Interpretable Tabular Learning (Sercan, Pfister, 2019).
See https://arxiv.org/abs/1908.07442 for details.</p>
    </div>



    <h2 class="hasAnchor" id="format"><a class="anchor" href="#format"></a>Format</h2>

    <p><code><a href='https://r6.r-lib.org/reference/R6Class.html'>R6::R6Class()</a></code> inheriting from <a href='LearnerClassifKeras.html'>LearnerClassifKeras</a>.</p>
    <h2 class="hasAnchor" id="construction"><a class="anchor" href="#construction"></a>Construction</h2>

    
<pre><span class='va'>LearnerClassifTabNet</span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='op'>)</span>
<span class='fu'>mlr3</span><span class='fu'>::</span><span class='va'><a href='https://mlr3.mlr-org.com/reference/mlr_learners.html'>mlr_learners</a></span><span class='op'>$</span><span class='fu'>get</span><span class='op'>(</span><span class='st'>"classif.tabnet"</span><span class='op'>)</span>
<span class='fu'>mlr3</span><span class='fu'>::</span><span class='fu'><a href='https://mlr3.mlr-org.com/reference/mlr_sugar.html'>lrn</a></span><span class='op'>(</span><span class='st'>"classif.tabnet"</span><span class='op'>)</span>
</pre>

    <h2 class="hasAnchor" id="hyper-parameter-tuning"><a class="anchor" href="#hyper-parameter-tuning"></a>Hyper Parameter Tuning</h2>

    


<p>Additional Arguments:</p><ul>
<li><p><code>embed_size</code>: Size of embedding for categorical, character and ordered factors.
Defaults to <code><a href='https://rdrr.io/r/base/Extremes.html'>min(600L, round(1.6 * length(levels)^0.56))</a></code>.</p></li>
<li><p><code>stacked</code>: Should a <code>StackedTabNetModel</code> be used instead of a normal <code>TabNetModel</code>? <br /></p></li>
</ul>

    <h2 class="hasAnchor" id="excerpt-from-paper"><a class="anchor" href="#excerpt-from-paper"></a>Excerpt from paper</h2>

    

<p>We consider datasets ranging from 10K to 10M training points, with varying degrees of fitting
difficulty. TabNet obtains high performance for all with a few general principles on hyperparameter
selection: <br /></p><ul>
<li><p>Most datasets yield the best results for Nsteps between 3 and 10. Typically, larger datasets and
more complex tasks require a larger Nsteps. A very high value of Nsteps may suffer from
overfitting and yield poor generalization. <br /></p></li>
<li><p>Adjustment of the values of Nd and Na is the most efficient way of obtaining a trade-off
between performance and complexity. Nd = Na is a reasonable choice for most datasets. A
very high value of Nd and Na may suffer from overfitting and yield poor generalization. <br /></p></li>
<li><p>An optimal choice of \(\gamma\) can have a major role on the overall performance. Typically a larger
Nsteps value favors for a larger \(\gamma\). <br /></p></li>
<li><p>A large batch size is beneficial for performance - if the memory constraints permit, as large
as 1-10 % of the total training dataset size is suggested. The virtual batch size is typically
much smaller than the batch size. <br /></p></li>
<li><p>Initially large learning rate is important, which should be gradually decayed until convergence. <br /></p></li>
</ul>

<p>The R class wraps a python implementation found in <a href='https://github.com/titu1994/tf-TabNet/tree/master/tabnet'>https://github.com/titu1994/tf-TabNet/tree/master/tabnet</a>.</p>
    <h2 class="hasAnchor" id="parameters"><a class="anchor" href="#parameters"></a>Parameters</h2>

    

<ul>
<li><p><code>feature_dim</code> (N_a): Dimensionality of the hidden representation in feature
transformation block. Each layer first maps the representation to a
2*feature_dim-dimensional output and half of it is used to determine the
nonlinearity of the GLU activation where the other half is used as an
input to GLU, and eventually feature_dim-dimensional output is
transferred to the next layer. <br /></p></li>
<li><p><code>output_dim</code> (N_d): Dimensionality of the outputs of each decision step, which is
later mapped to the final classification or regression output. <br /></p></li>
<li><p><code>num_features</code>: The number of input features (i.e the number of columns for
tabular data assuming each feature is represented with 1 dimension). <br /></p></li>
<li><p><code>num_decision_steps</code> (N_steps): Number of sequential decision steps. <br /></p></li>
<li><p><code>relaxation_factor</code> (gamma): Relaxation factor that promotes the reuse of each
feature at different decision steps. When it is 1, a feature is enforced
to be used only at one decision step and as it increases, more <br />
flexibility is provided to use a feature at multiple decision steps.</p></li>
<li><p><code>sparsity_coefficient</code> (lambda_sparse): Strength of the sparsity regularization.
Sparsity may provide a favorable inductive bias for convergence to
higher accuracy for some datasets where most of the input features are redundant. <br /></p></li>
<li><p><code>norm_type</code>: Type of normalization to perform for the model. Can be either
'batch' or 'group'. 'group' is the default. <br /></p></li>
<li><p><code>batch_momentum</code>: Momentum in ghost batch normalization. <br /></p></li>
<li><p><code>virtual_batch_size</code>: Virtual batch size in ghost batch normalization. The
overall batch size should be an integer multiple of virtual_batch_size. <br /></p></li>
<li><p><code>num_groups</code>: Number of groups used for group normalization. The number of groups
should be a divisor of the number of input features (<code>num_features</code>) <br /></p></li>
<li><p><code>epsilon</code>: A small number for numerical stability of the entropy calculations. <br /></p></li>
</ul>

    <h2 class="hasAnchor" id="learner-methods"><a class="anchor" href="#learner-methods"></a>Learner Methods</h2>

    


<p>Keras Learners offer several methods for easy access to the
stored models.</p><ul>
<li><p><code>.$plot()</code><br />
Plots the history, i.e. the train-validation loss during training.</p></li>
<li><p><code>.$save(file_path)</code><br />
Dumps the model to a provided file_path in 'h5' format.</p></li>
<li><p><code>.$load_model_from_file(file_path)</code><br />
Loads a model saved using <code>saved</code> back into the learner.
The model needs to be saved separately when the learner is serialized.
In this case, the learner can be restored from this function.
Currently not implemented for 'TabNet'.</p></li>
<li><p><code>.$lr_find(task, epochs, lr_min, lr_max, batch_size)</code><br />
Employ an implementation of the learning rate finder as popularized by
Jeremy Howard in fast.ai (http://course.fast.ai/) for the learner.
For more info on parameters, see <code>find_lr</code>.</p></li>
</ul>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Sercan, A. and Pfister, T. (2019): TabNet. <a href='https://arxiv.org/abs/1908.07442'>https://arxiv.org/abs/1908.07442</a>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='https://mlr3misc.mlr-org.com/reference/Dictionary.html'>Dictionary</a> of <a href='https://mlr3.mlr-org.com/reference/Learner.html'>Learners</a>: <a href='https://mlr3.mlr-org.com/reference/mlr_learners.html'>mlr3::mlr_learners</a></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>learner</span> <span class='op'>=</span> <span class='fu'>mlr3</span><span class='fu'>::</span><span class='fu'><a href='https://mlr3.mlr-org.com/reference/mlr_sugar.html'>lrn</a></span><span class='op'>(</span><span class='st'>"classif.tabnet"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Loading required package: tensorflow</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>learner</span><span class='op'>)</span>
</div><div class='output co'>#&gt; &lt;LearnerClassifTabNet:classif.tabnet&gt;
#&gt; * Model: -
#&gt; * Parameters: epochs=100, validation_split=0, batch_size=128,
#&gt;   callbacks=&lt;list&gt;, low_memory=FALSE, verbose=0, embed_size=&lt;NULL&gt;,
#&gt;   stacked=FALSE, batch_momentum=0.98, relaxation_factor=1,
#&gt;   sparsity_coefficient=1e-05, num_decision_steps=2, feature_dim=64,
#&gt;   output_dim=32, num_groups=1, epsilon=1e-05, norm_type=group,
#&gt;   virtual_batch_size=&lt;NULL&gt;, loss=categorical_crossentropy,
#&gt;   optimizer=&lt;keras.optimizer_v2.adam.Adam&gt;, metrics=accuracy
#&gt; * Packages: keras, tensorflow, reticulate
#&gt; * Predict Type: response
#&gt; * Feature types: integer, numeric, factor, logical, ordered
#&gt; * Properties: multiclass, twoclass</div><div class='input'>
<span class='co'># available parameters:</span>
<span class='va'>learner</span><span class='op'>$</span><span class='va'>param_set</span><span class='op'>$</span><span class='fu'>ids</span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1] "epochs"               "model"                "class_weight"        
#&gt;  [4] "validation_split"     "batch_size"           "callbacks"           
#&gt;  [7] "low_memory"           "verbose"              "embed_size"          
#&gt; [10] "stacked"              "num_layers"           "batch_momentum"      
#&gt; [13] "relaxation_factor"    "sparsity_coefficient" "num_decision_steps"  
#&gt; [16] "feature_dim"          "output_dim"           "num_groups"          
#&gt; [19] "epsilon"              "norm_type"            "virtual_batch_size"  
#&gt; [22] "loss"                 "optimizer"            "metrics"             </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Florian Pfisterer, Jacky Poon, Michel Lang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '9c3abd63d461245fb19ebd2d2645c5b0',
    indexName: 'mlr3',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


